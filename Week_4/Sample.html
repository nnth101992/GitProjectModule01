<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
</head>
<body>
<canvas id="canvas" width="480" height="270" style="border: 1px solid #000000"></canvas>
</body>
<script>
     //ve man hinh
     let myGameArea = {
          canvas: document.getElementById("canvas"),
          start: function () {
               this.context = this.canvas.getContext("2d");
               this.interval = setInterval(updateGameArea, 20);
               // bat su kien ban phim
               window.addEventListener('keydown', function (e) {
                    myGameArea.keys = (myGameArea.keys || []);
                    myGameArea.keys[e.keyCode] = true;
               });
               window.addEventListener('keyup', function (e) {
                    myGameArea.keys[e.keyCode] = false;
               });
          },
          // xoa man hinh de ve lai
          clear: function () {
               this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
          }
     }

     let birdGame;
     let bugList;

     // ham de chay
     function startGame() {
          birdGame = new component(30, 30, "red", 10, 120);

          bugList = new Array(10);
          for (let i = 0; i < 10; i++) {
               let x = Math.floor(Math.random() * 200 + 100);
               let y = Math.floor(Math.random() * 200 + 100);
               let bug = new component(20, 20, "green", x, y);
               bugList[i] = bug;
          }
          //khoi tao man hinh canvas
          myGameArea.start();
          // ve cac doi tuong trong canvas
          birdGame.draw();
          for (let i = 0; i < 2; i++) {
               //console.log(bugList[i]);
               bugList[i].draw();
          }
     }

     // khai bao lop de tao cac doi tuong nguoi choi
     function component(width, height, color, x, y) {
          this.width = width;
          this.height = height;
          this.color = color;
          this.speedX = 0;
          this.speedY = 0;
          this.checkX = true;
          this.checkY = true;
          this.x = x;
          this.y = y;
          // ham ve can vas
          this.draw = function () {
               ctx = myGameArea.context;
               ctx.fillStyle = this.color;
               ctx.fillRect(this.x, this.y, this.width, this.height);
          }
          // cap nhat lai toa do cua doi tuong de di chuyen
          this.newPos = function () {
               this.x += this.speedX;
               this.y += this.speedY;
          }
     }

     //thay doi vi tri cac doi tuong bang cach cap nhat toa do cua doi tuong
     function updateGameArea() {
          myGameArea.clear();
          birdGame.speedX = 0;
          birdGame.speedY = 0;
          // bug.speedX = 0;
          //bug.speedY = 0;
          //di chuyen, thay doi toa do bang cach cong them 1 bien di chuyen
          // bug.speedX = Math.floor(Math.random() * 10 + 1);
          // bug.speedY = Math.floor(Math.random() * 10 + 1);
          for (let i = 0; i < 10; i++) {
               let bug = bugList[i];
               bug.speedX = Math.floor(Math.random() * 2 + 1);
               bug.speedY = Math.floor(Math.random() * 2 + 1);
               if (bug.x + bug.speedX > 470) {
                    bug.checkX = false;
               }

               if (bug.x + bug.speedX < 0) {
                    bug.checkX = true;
               }

               if (!bug.checkX) {
                    bug.speedX = -Math.floor(Math.random() * 2 + 1);
               } else {
                    bug.speedX = Math.floor(Math.random() * 2 + 1);
               }

               if (bug.y + bug.speedY > 260) {
                    bug.checkY = false;
               }

               if (bug.y + bug.speedY < 0) {
                    bug.checkY = true;
               }

               if (!bug.checkY) {
                    bug.speedY = -Math.floor(Math.random() * 2 + 1);
               } else {
                    bug.speedY = Math.floor(Math.random() * 2 + 1);
               }

               bug.newPos();
               bug.draw();
          }

          // addListener
          if (myGameArea.keys && myGameArea.keys[37]) {
               birdGame.speedX = -1;
          }
          if (myGameArea.keys && myGameArea.keys[39]) {
               birdGame.speedX = 1;
          }

          if (myGameArea.keys && myGameArea.keys[38]) {
               birdGame.speedY = -1;
          }
          if (myGameArea.keys && myGameArea.keys[40]) {
               birdGame.speedY = 1;
          }
          // bug.newPos();
          //bug.draw();
          birdGame.newPos();
          birdGame.draw();
     }

     //goi ham chay
     startGame();

</script>
</html>